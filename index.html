<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Projectile Motion Windows</title>
  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #fdfdf5; /* beige/white */
      position: relative;
    }
    #spawnBtn {
      padding: 16px 24px;
      font-size: 18px;
      font-weight: bold;
      border: 1px solid #ccc;
      border-radius: 10px;
      background: #fff;
      color: #333;
      cursor: pointer;
      z-index: 1000;
      position: relative;
    }
    .window {
      position: absolute;
      width: 260px;
      height: 180px;
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 10px;
      overflow: hidden;
    }
    canvas {
      width: 100%;
      height: 100%;
      display: block;
      background: #fff;
    }
  </style>
</head>
<body>
  <button id="spawnBtn">Add Simulation</button>

  <script>
    function createWindow() {
      const win = document.createElement('div');
      win.className = 'window';

      const vw = window.innerWidth;
      const vh = window.innerHeight;

      // Button dimensions (centered)
      const btn = document.getElementById('spawnBtn');
      const btnRect = btn.getBoundingClientRect();

      let x, y, safe = false;
      while (!safe) {
        x = Math.random() * (vw - 280);
        y = Math.random() * (vh - 200);
        if (
          x + 260 < btnRect.left ||
          x > btnRect.right ||
          y + 180 < btnRect.top ||
          y > btnRect.bottom
        ) {
          safe = true;
        }
      }

      win.style.left = x + 'px';
      win.style.top = y + 'px';

      const canvas = document.createElement('canvas');
      canvas.width = 260;
      canvas.height = 180;
      win.appendChild(canvas);
      document.body.appendChild(win);

      const ctx = canvas.getContext('2d');
      let t = 0;
      // Larger random parameters
      const v0 = 50 + Math.random() * 100; // 50–150 m/s
      const theta = (10 + Math.random() * 70) * Math.PI / 180; // 10–80°
      const g = 5 + Math.random() * 15; // 5–20 m/s²
      const scale = 1 + Math.random() * 2; // 1–3 px/m
      const baseX = 20, baseY = canvas.height - 20;
      let path = [];

      function draw() {
        ctx.fillStyle = '#fff';
        ctx.fillRect(0,0,canvas.width,canvas.height);

        // ground
        ctx.strokeStyle = '#ccc';
        ctx.beginPath();
        ctx.moveTo(0, baseY);
        ctx.lineTo(canvas.width, baseY);
        ctx.stroke();

        // physics
        const vx = v0 * Math.cos(theta);
        const vy = v0 * Math.sin(theta);
        const x = vx * t;
        const y = vy * t - 0.5 * g * t * t;

        if (y >= 0) {
          path.push({x,y});
        }

        // trace
        ctx.strokeStyle = '#999';
        ctx.beginPath();
        path.forEach((p,i)=>{
          const px = baseX + p.x/scale;
          const py = baseY - p.y/scale;
          if(i===0) ctx.moveTo(px,py);
          else ctx.lineTo(px,py);
        });
        ctx.stroke();

        // projectile
        if (y >= 0) {
          ctx.fillStyle = '#333';
          ctx.beginPath();
          ctx.arc(baseX + x/scale, baseY - y/scale, 4, 0, Math.PI*2);
          ctx.fill();
        }

        t += 0.05;
        requestAnimationFrame(draw);
      }
      draw();
    }

    document.getElementById('spawnBtn').addEventListener('click', createWindow);
  </script>
</body>
</html>
